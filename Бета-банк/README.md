## Прогноз поведения клиентов для "Бета-Банка"

[HTML](https://github.com/fromufawithlove/Portfolio/blob/main/%D0%91%D0%B5%D1%82%D0%B0-%D0%B1%D0%B0%D0%BD%D0%BA/BetaBank.html) [ipynb](https://github.com/fromufawithlove/Portfolio/blob/main/%D0%91%D0%B5%D1%82%D0%B0-%D0%B1%D0%B0%D0%BD%D0%BA/BetaBank.ipynb)

### Описание проекта

Из «Бета-Банка» стали уходить клиенты. Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 
Постройте модель с предельно большим значением F1-меры.  Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.

### Описание данных

Признаки

- RowNumber — индекс строки в данных
- CustomerId — уникальный идентификатор клиента
- Surname — фамилия
- CreditScore — кредитный рейтинг
- Geography — страна проживания
- Gender — пол
- Age — возраст
- Tenure — сколько лет человек является клиентом банка
- Balance — баланс на счёте
- NumOfProducts — количество продуктов банка, используемых клиентом
- HasCrCard — наличие кредитной карты
- IsActiveMember — активность клиента
- EstimatedSalary — предполагаемая зарплата
 
Целевой признак

- Exited — факт ухода клиента

### Выводы

Подготовка данных:

- Нам дан датафрейм в 10 000 строк и 14 столбцов
- Пропуски есть только в столбце tenure в количестве 909 строк
- Дубликатов нет

Было сделано:

- Приведены названия столбцов и их содержимого к нижнему регистру
- Удалены стоблцы 'rownumber'- номер строки, 'customerid' - id клиента, 'surname' - фамилия клиента, как не важные для дальнейших исследований
- Заполнены пропуски в столбце tenure - общий срок обслуживания клиента в банке - средним значением по столбцу.
- Получена на выходе база с 10 000 строк и 11 столбцов

Исследование задачи:

- Категориальные данные столбцов были переведены в числовые методом One-Hot Encoding
- Подготовленные данные были масштабированы по столбцам 'creditscore', 'age', 'tenure', 'balance', 'numofproducts', 'estimatedsalary'
- Данные были разделены на тестовую, валидационную и обучающую выборки в соотношении 60/20/20
- У целевого признака наблюдается дисбаланс классов в пользу значения 0 (оставшиеся клиенты)

Построение моделей без учета дисбаланса:

- Построили модели Дерево решений, Случайный лес и Логистическая регрессия при дисбалансе классов с оптимальными показателями для метрики F1
- Получили лучший показатель F1 для модели Случайный лес - 0.57
- Построили матрицы ошибок для всех трех моделей - они показывают, что все три модели хорошо предсказывают доминирующий класс, но точность предсказания класса 1 (уход из банка) не превышает точности 45%

Построение моделей с учетом дисбаланса:

- Построили модели Логистической регрессии, Дерево решений и Случайного леса для разных способов балансировки классов : взвешивание, увеличение и уменьшение выборки
- Собрали данные в таблицу для выбора лучшего показателя метрики F1
- Наилучший показатель метрики F1 на обучающей выборке показала модель Случайного леса (est = 100, depth = 9) при балансировке классов методом взвешивания
- Качество предсказаний модели True Negative - 89%, True Positive - 65%, F1 = 0.628, AUC-ROC = 0.852

Тестирование модели:

- Протестировали лучшую модель на тестовой выборке
- Получили значения метрик F1: 0.6120591581342435 и AUC-ROC: 0.859968429147722
- Полученное значение F1 больше 0.59 по заданию
- Значение AUC-ROC близко к 1
- Построили график ROC - кривой
- Проверили модель на адекватность, сравнив Accuracy_score константой и финальной модели. Модель прошла тест на адекватность

